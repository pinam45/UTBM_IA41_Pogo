project(UTBM_IA41_Pogo)
cmake_minimum_required(VERSION 3.7)

# Don't allow to build in sources otherwise a makefile not generated by CMake can be overrided
set(CMAKE_DISABLE_SOURCE_CHANGES ON)
set(CMAKE_DISABLE_IN_SOURCE_BUILD ON)

# Place generated binaries in build/bin
set(
  CMAKE_RUNTIME_OUTPUT_DIRECTORY
  ${CMAKE_BINARY_DIR}/build/bin
)

# Place generated libs in build/lib
set(
  CMAKE_LIBRARY_OUTPUT_DIRECTORY
  ${CMAKE_BINARY_DIR}/build/lib
)
set(
  CMAKE_ARCHIVE_OUTPUT_DIRECTORY
  ${CMAKE_BINARY_DIR}/build/lib
)

# By default build in Release mode
if( NOT CMAKE_BUILD_TYPE )
	set(CMAKE_BUILD_TYPE "Release")
endif()

set(CMAKE_CXX_STANDARD 14)

include(cmake/config.cmake)
if(CMAKE_COMPILER_IS_GNUCXX)
	include(cmake/gcc-settings.cmake)
endif()

if(CMAKE_BUILD_TYPE STREQUAL "Debug")
	set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -D\"DEBUG\"")
	message(STATUS "Debug mode: DEBUG macro defined")
endif()

add_subdirectory(PFC_C)

include_directories(
  ${CMAKE_CURRENT_SOURCE_DIR}/PFC_C/ConsoleControl/include/
  ${CMAKE_CURRENT_SOURCE_DIR}/PFC_C/Logger/include/
  ${CMAKE_CURRENT_SOURCE_DIR}/PFC_Cpp/Dispatcher/include/
  ${CMAKE_CURRENT_SOURCE_DIR}/PFC_Cpp/Logger/include/
  ${CMAKE_CURRENT_SOURCE_DIR}/Pogo/include/
)

link_directories(
  ${CMAKE_BINARY_DIR}/build/lib/
)

message(STATUS "Sources preparation")
file(GLOB_RECURSE SOURCE_FILES
  "${CMAKE_CURRENT_SOURCE_DIR}/Pogo/src/*"
  )
message(" -> Sources prepared")

add_executable(
  UTBM_IA41_Pogo
  ${SOURCE_FILES}
  Pogo/src/Board.cpp Pogo/include/Board.hpp Pogo/src/AI.cpp Pogo/include/AI.hpp Pogo/src/Node.cpp Pogo/include/Node.hpp)
add_dependencies(UTBM_IA41_Pogo PFC_C)
target_link_libraries(UTBM_IA41_Pogo PFC_C)
